#include <stdio.h>
#include <libxml/parser.h>
#include <libxml/xmlstring.h>
#include <string.h>
#include <klee/klee.h>
#define SMALL_LENGTH 20
#define LARGE_LENGTH 2

char* getNormalStr(int size){
    char *str = (char *)malloc(size);
//    klee_make_symbolic(str, size, "normal");
    if(str == NULL){
        printf("Normal string allocation error\n");
        exit(1);
    }
    memset(str, 'A', size-1);
    str[size-1] = 0;
    return str;
}

char* getLongStr(int size){
    char *str = (char *)malloc(size);
//    klee_make_symbolic(str, size, "long");
    if(str == NULL){
        printf("Large string allocation error\n");
        exit(1);
    }
    memset(str, 'A', size-1);
    str[size-1] = 0;
    return str;
}


void crash(int x, int y) {
    char *longstr = getLongStr(x);
    char *shortstr = getNormalStr(y);
//    klee_make_symbolic(longstr, LARGE_LENGTH, "longstr");
//    klee_make_symbolic( shortstr, SMALL_LENGTH, "shortstr");
    xmlStrcat((xmlChar *)longstr, (xmlChar *)shortstr);
}

int main(int argc, char **argv) {
    int a = atoi(argv[1]);
    int b = atoi(argv[2]);

    crash(a,b);
    return(0);
}
